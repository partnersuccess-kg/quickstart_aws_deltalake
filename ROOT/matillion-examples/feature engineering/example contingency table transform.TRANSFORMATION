{"job":{"components":{"391651":{"id":391651,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":407,"y":380,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[391669],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"All flights"}}}},"visible":true},"2":{"slot":2,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_training_flights"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flight_date"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"departure_time"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"crs_departure_time"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"arrival_time"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"crs_arrival_time"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"carrier"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"flight_number"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"actual_elapsed_time"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"airtime"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"origin"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"destination"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"distance_type"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"distance"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"taxi_in"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"taxi_out"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_database}"}}}},"visible":true},"6":{"slot":6,"name":"Offset Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"8":{"slot":8,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391654":{"id":391654,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":737,"y":298,"width":32,"height":32,"inputConnectorIDs":[391659],"outputConnectorIDs":[391668],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Business Rules"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"arrival_time"},"2":{"slot":2,"type":"STRING","value":"Not"},"3":{"slot":3,"type":"STRING","value":"Null"},"4":{"slot":4,"type":"STRING","value":""}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"crs_arrival_time"},"2":{"slot":2,"type":"STRING","value":"Not"},"3":{"slot":3,"type":"STRING","value":"Null"},"4":{"slot":4,"type":"STRING","value":""}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"airtime"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391655":{"id":391655,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":609,"y":378,"width":32,"height":32,"inputConnectorIDs":[391669,391671],"outputConnectorIDs":[391659],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Fed Holidays"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"All flights"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"f"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us_holiday_observance"},"2":{"slot":2,"type":"STRING","value":"ob"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"`f`.`flight_date` = `ob`.`calendardate`"},"2":{"slot":2,"type":"STRING","value":"f_Left_ob"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"f.flight_date"},"2":{"slot":2,"type":"STRING","value":"flight_date"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"f.crs_departure_time"},"2":{"slot":2,"type":"STRING","value":"crs_departure_time"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"f.arrival_time"},"2":{"slot":2,"type":"STRING","value":"arrival_time"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"f.crs_arrival_time"},"2":{"slot":2,"type":"STRING","value":"crs_arrival_time"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"f.flight_number"},"2":{"slot":2,"type":"STRING","value":"flight_number"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"f.airtime"},"2":{"slot":2,"type":"STRING","value":"airtime"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"f.origin"},"2":{"slot":2,"type":"STRING","value":"origin"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"f.destination"},"2":{"slot":2,"type":"STRING","value":"destination"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"f.actual_elapsed_time"},"2":{"slot":2,"type":"STRING","value":"actual_elapsed_time"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"ob.observance"},"2":{"slot":2,"type":"STRING","value":"Observance"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391656":{"id":391656,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-319648201,"x":1008,"y":384,"width":32,"height":32,"inputConnectorIDs":[391658],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Flight delay analysis - granular data (view)"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_database}"}}}},"visible":true},"3":{"slot":3,"name":"View Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"v_flight_delay_analysis"}}}},"visible":true},"4":{"slot":4,"name":"Table Properties","elements":{},"visible":true},"11":{"slot":11,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391657":{"id":391657,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239424,"x":1296,"y":224,"width":32,"height":32,"inputConnectorIDs":[391670],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Flight delay analysis - summary data"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_database}"}}}},"visible":true},"3":{"slot":3,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"summary_flight_delay"}}}},"visible":true},"4":{"slot":4,"name":"Partition Keys","elements":{},"visible":true},"5":{"slot":5,"name":"Table Properties","elements":{},"visible":true},"6":{"slot":6,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391660":{"id":391660,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":855,"y":302,"width":32,"height":32,"inputConnectorIDs":[391668],"outputConnectorIDs":[391658,391665],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Binning"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"60 * CAST((`crs_arrival_time` - MOD(`crs_arrival_time`, 100)) / 100 AS INTEGER) + MOD(`crs_arrival_time`, 100)"},"2":{"slot":2,"type":"STRING","value":"crs_arrival_mpm"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"60 * CAST((`arrival_time` - MOD(`arrival_time`, 100)) / 100 AS INTEGER) + MOD(`arrival_time`, 100)"},"2":{"slot":2,"type":"STRING","value":"arrival_mpm"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"CASE\n     /* Flights due to arrive late evening and actually arriving next day */\n     WHEN `arrival_mpm` - `crs_arrival_mpm` < -500\n     THEN `arrival_mpm` - `crs_arrival_mpm` + 1440\n     /* Flights due to arrive early morning but actually arriving the evening of the day before */\n     WHEN `arrival_mpm` - `crs_arrival_mpm` > 1200\n     THEN `arrival_mpm` - `crs_arrival_mpm` - 1440\n     /* For most flights the day is the same */\n     ELSE `arrival_mpm` - `crs_arrival_mpm`\nEND"},"2":{"slot":2,"type":"STRING","value":"DelayMinutes"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN `DelayMinutes` >= 45 THEN 'Large Delay'\n     WHEN `DelayMinutes` >= 15 THEN 'Medium Delay'\n     ELSE 'On Time'\nEND"},"2":{"slot":2,"type":"STRING","value":"LatenessCategory"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN `Observance` IS NULL THEN 'No Holiday'\n     ELSE 'Holiday'\nEND"},"2":{"slot":2,"type":"STRING","value":"HolidayCategory"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391661":{"id":391661,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":608,"y":224,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[391671],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us_holiday_observance"}}}},"visible":true},"2":{"slot":2,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us_holiday_observance"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CalendarDate"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Observance"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_database}"}}}},"visible":true},"6":{"slot":6,"name":"Offset Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"8":{"slot":8,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391662":{"id":391662,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":609793074,"x":1152,"y":224,"width":32,"height":32,"inputConnectorIDs":[391664],"outputConnectorIDs":[391670],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Proportions"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"holidaycategory"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{},"visible":true},"5":{"slot":5,"name":"Lower Bound","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Upper Bound","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"7":{"slot":7,"name":"Lower Bound Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"8":{"slot":8,"name":"Upper Bound Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"9":{"slot":9,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sum"},"2":{"slot":2,"type":"STRING","value":"count_flight_date"},"3":{"slot":3,"type":"STRING","value":"CountByHolidayCategory"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391663":{"id":391663,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":1008,"y":224,"width":32,"height":32,"inputConnectorIDs":[391665],"outputConnectorIDs":[391664],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Top level aggregation"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"latenesscategory"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"holidaycategory"}}}},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flight_date"},"2":{"slot":2,"type":"STRING","value":"Count"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"391658":{"id":391658,"sourceID":391660,"targetID":391656},"391659":{"id":391659,"sourceID":391655,"targetID":391654},"391664":{"id":391664,"sourceID":391663,"targetID":391662},"391665":{"id":391665,"sourceID":391660,"targetID":391663},"391668":{"id":391668,"sourceID":391654,"targetID":391660},"391669":{"id":391669,"sourceID":391651,"targetID":391655},"391670":{"id":391670,"sourceID":391662,"targetID":391657},"391671":{"id":391671,"sourceID":391661,"targetID":391655}},"notes":{"391652":{"id":391652,"x":286,"y":194,"width":143,"height":78,"text":"Run the \"example contingency table setup\" job first to create the database objects","colour":"e6e63c"},"391653":{"id":391653,"x":519,"y":169,"width":395,"height":255,"text":"These are the business rules and definitions that need to be shared","colour":"00ce4f"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"example contingency table transform","description":"Create the database objects for the Contingency Table example","type":"TRANSFORMATION","tag":"063e970b-ed8f-4208-9244-68f3b3c57a9a"}}