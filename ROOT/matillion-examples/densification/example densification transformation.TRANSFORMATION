{"job":{"components":{"391601":{"id":391601,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1439414779,"x":614,"y":213,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[391621],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Spine"}}}},"visible":true},"2":{"slot":2,"name":"Starting Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"0"}}}},"visible":true},"3":{"slot":3,"name":"Increment Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true},"4":{"slot":4,"name":"End Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"5000"}}}},"visible":true},"5":{"slot":5,"name":"Output Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sequence"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391602":{"id":391602,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":486,"y":309,"width":32,"height":32,"inputConnectorIDs":[391622],"outputConnectorIDs":[391610,391616],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"String to Date"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TO_DATE(`timestamp`, 'yyyy-MM-dd')"},"2":{"slot":2,"type":"STRING","value":"datevalue"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391603":{"id":391603,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":870,"y":309,"width":32,"height":32,"inputConnectorIDs":[391619],"outputConnectorIDs":[391628],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add date"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DATE_ADD(`start_date`, `sequence`)"},"2":{"slot":2,"type":"STRING","value":"densified_date"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN `measurement_date` IS NULL THEN NULL ELSE `sequence` END"},"2":{"slot":2,"type":"STRING","value":"gapseq"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391606":{"id":391606,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":742,"y":309,"width":32,"height":32,"inputConnectorIDs":[391610,391620,391621],"outputConnectorIDs":[391619],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Find missing dates"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Spine"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MinMax"},"2":{"slot":2,"type":"STRING","value":"mm"},"3":{"slot":3,"type":"STRING","value":"Inner"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"String to Date"},"2":{"slot":2,"type":"STRING","value":"o"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DATE_ADD(`mm`.`min_datevalue`, `s`.`sequence`) <= `mm`.`max_datevalue`"},"2":{"slot":2,"type":"STRING","value":"s_Inner_mm"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"`o`.`datevalue` = DATE_ADD(`mm`.`min_datevalue`, `s`.`sequence`)"},"2":{"slot":2,"type":"STRING","value":"s_Left_o"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s.sequence"},"2":{"slot":2,"type":"STRING","value":"sequence"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"mm.min_datevalue"},"2":{"slot":2,"type":"STRING","value":"start_date"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"o.datevalue"},"2":{"slot":2,"type":"STRING","value":"measurement_date"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"o.eur"},"2":{"slot":2,"type":"STRING","value":"EUR"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391607":{"id":391607,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":304,"y":304,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[391622],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_xrate"}}}},"visible":true},"2":{"slot":2,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_xrate"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Timestamp"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"EUR"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_database}"}}}},"visible":true},"6":{"slot":6,"name":"Offset Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"8":{"slot":8,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391608":{"id":391608,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1302,"y":309,"width":32,"height":32,"inputConnectorIDs":[391629],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rolling Mean coalesced"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"COALESCE(`eur`, `eur_rolling_mean`)"},"2":{"slot":2,"type":"STRING","value":"EUR_rolling_mean_coalesced"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391609":{"id":391609,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":1190,"y":469,"width":32,"height":32,"inputConnectorIDs":[391631],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Linear Backfill"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WITH data AS (\nSELECT `sequence`, `datevalue`, `gapseq`, `eur`,\n       LAST_VALUE(`gapseq`, TRUE) OVER (ORDER BY `datevalue` ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS prior_gapseq,\n       FIRST_VALUE(`gapseq`, TRUE) OVER (ORDER BY `datevalue` ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS next_gapseq,\n       LAST_VALUE(`eur`, TRUE) OVER (ORDER BY `datevalue` ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS prior_EUR,\n       FIRST_VALUE(`eur`, TRUE) OVER (ORDER BY `datevalue` ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS next_EUR\nFROM $T{Renamer})\nSELECT `sequence`, `datevalue`, `gapseq`, `eur`,\n       CASE WHEN `eur` IS NULL\n            THEN prior_EUR + ((next_EUR - prior_EUR) * (`sequence` - `prior_gapseq`) / (`next_gapseq` - `prior_gapseq`))\n            ELSE `eur`\n       END AS `EUR_linear_fill`\nFROM data\nORDER BY `sequence` DESC"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391611":{"id":391611,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":608,"y":400,"width":32,"height":32,"inputConnectorIDs":[391616],"outputConnectorIDs":[391620],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MinMax"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"datevalue"},"2":{"slot":2,"type":"STRING","value":"Min"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"datevalue"},"2":{"slot":2,"type":"STRING","value":"Max"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391612":{"id":391612,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":1030,"y":309,"width":32,"height":32,"inputConnectorIDs":[391628],"outputConnectorIDs":[391617,391618,391623,391631],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Renamer"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sequence"},"2":{"slot":2,"type":"STRING","value":"sequence"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"densified_date"},"2":{"slot":2,"type":"STRING","value":"datevalue"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"gapseq"},"2":{"slot":2,"type":"STRING","value":"gapseq"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"EUR"},"2":{"slot":2,"type":"STRING","value":"EUR"}}}},"visible":true},"3":{"slot":3,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391613":{"id":391613,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1190,"y":229,"width":32,"height":32,"inputConnectorIDs":[391618],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Last Known"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_VALUE(`eur`, TRUE) OVER (ORDER BY `datevalue` ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)"},"2":{"slot":2,"type":"STRING","value":"EUR_last_known"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391614":{"id":391614,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":609793074,"x":1190,"y":309,"width":32,"height":32,"inputConnectorIDs":[391617],"outputConnectorIDs":[391629],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rolling Mean"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"datevalue"},"2":{"slot":2,"type":"STRING","value":"Asc"}}}},"visible":true},"5":{"slot":5,"name":"Lower Bound","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"offset preceding"}}}},"visible":true},"6":{"slot":6,"name":"Upper Bound","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"current row"}}}},"visible":true},"7":{"slot":7,"name":"Lower Bound Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"3"}}}},"visible":true},"8":{"slot":8,"name":"Upper Bound Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"3"}}}},"visible":false},"9":{"slot":9,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Average"},"2":{"slot":2,"type":"STRING","value":"EUR"},"3":{"slot":3,"type":"STRING","value":"EUR_rolling_mean"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391615":{"id":391615,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1190,"y":149,"width":32,"height":32,"inputConnectorIDs":[391623],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Zero Filled"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NVL(`eur`, 0)"},"2":{"slot":2,"type":"STRING","value":"EUR_zero_filled"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"391610":{"id":391610,"sourceID":391602,"targetID":391606},"391616":{"id":391616,"sourceID":391602,"targetID":391611},"391617":{"id":391617,"sourceID":391612,"targetID":391614},"391618":{"id":391618,"sourceID":391612,"targetID":391613},"391619":{"id":391619,"sourceID":391606,"targetID":391603},"391620":{"id":391620,"sourceID":391611,"targetID":391606},"391621":{"id":391621,"sourceID":391601,"targetID":391606},"391622":{"id":391622,"sourceID":391607,"targetID":391602},"391623":{"id":391623,"sourceID":391612,"targetID":391615},"391628":{"id":391628,"sourceID":391603,"targetID":391612},"391629":{"id":391629,"sourceID":391614,"targetID":391608},"391631":{"id":391631,"sourceID":391612,"targetID":391609}},"notes":{"391604":{"id":391604,"x":1161,"y":368,"width":155,"height":40,"text":"Linear Regression is a workspace notebook task","colour":"00ce4f"},"391605":{"id":391605,"x":235,"y":227,"width":135,"height":138,"text":"Start with the columns of interest, flattened from the raw JSON data","colour":"00ce4f"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"example densification transformation","description":null,"type":"TRANSFORMATION","tag":"671e5945-173a-4e1a-9b7a-f3a9df735352"}}