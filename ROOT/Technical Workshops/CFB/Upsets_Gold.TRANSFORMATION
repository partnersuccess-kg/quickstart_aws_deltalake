{"job":{"components":{"391968":{"id":391968,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":240,"y":128,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[391988],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BettingOdds"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"(SELECT \n   `awayConference`, \n   `awayScore`, \n   `awayTeam`, \n   `homeConference`, \n   `homeScore`, \n   `homeTeam`, \n   `id`, \n   `lines_awayMoneyline`, \n  `lines_formattedSpread`, \n  `lines_homeMoneyline`, \n  `lines_overUnder`, \n  `lines_overUnderOpen`, \n  `lines_provider`, \n  `lines_spread`, \n  `lines_spreadOpen`, \n   `season`, \n   `seasonType`, \n   `startDate`, \n   `week` \n FROM `partnersuccess`.`bettingodds_2017`) \n UNION ALL\n (SELECT \n   `awayConference`, \n   `awayScore`, \n   `awayTeam`, \n   `homeConference`, \n   `homeScore`, \n   `homeTeam`, \n   `id`,\n   `lines_awayMoneyline`, \n  `lines_formattedSpread`, \n  `lines_homeMoneyline`, \n  `lines_overUnder`, \n  `lines_overUnderOpen`, \n  `lines_provider`, \n  `lines_spread`, \n  `lines_spreadOpen`, \n   `season`, \n   `seasonType`, \n   `startDate`, \n   `week` \n FROM `partnersuccess`.`bettingodds_2018`) \n UNION ALL\n (SELECT \n   `awayConference`, \n   `awayScore`, \n   `awayTeam`, \n   `homeConference`, \n   `homeScore`, \n   `homeTeam`, \n   `id`, \n   `lines_awayMoneyline`, \n  `lines_formattedSpread`, \n  `lines_homeMoneyline`, \n  `lines_overUnder`, \n  `lines_overUnderOpen`, \n  `lines_provider`, \n  `lines_spread`, \n  `lines_spreadOpen`, \n   `season`, \n   `seasonType`, \n   `startDate`, \n   `week` \n FROM `partnersuccess`.`bettingodds_2019`) \n UNION ALL\n (SELECT \n   `awayConference`, \n   `awayScore`, \n   `awayTeam`, \n   `homeConference`, \n   `homeScore`, \n   `homeTeam`, \n   `id`, \n    `lines_awayMoneyline`, \n  `lines_formattedSpread`, \n  `lines_homeMoneyline`, \n  `lines_overUnder`, \n  `lines_overUnderOpen`, \n  `lines_provider`, \n  `lines_spread`, \n  `lines_spreadOpen`, \n   `season`, \n   `seasonType`, \n   `startDate`, \n   `week` \n FROM `partnersuccess`.`bettingodds_2020`) \n UNION ALL\n (SELECT \n   `awayConference`, \n   `awayScore`, \n   `awayTeam`, \n   `homeConference`, \n   `homeScore`, \n   `homeTeam`, \n   `id`, \n    `lines_awayMoneyline`, \n  `lines_formattedSpread`, \n  `lines_homeMoneyline`, \n  `lines_overUnder`, \n  `lines_overUnderOpen`, \n  `lines_provider`, \n  `lines_spread`, \n  `lines_spreadOpen`, \n   `season`, \n   `seasonType`, \n   `startDate`, \n   `week` \n FROM `partnersuccess`.`bettingodds_2021`) \n "}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391970":{"id":391970,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":624,"y":128,"width":32,"height":32,"inputConnectorIDs":[391991],"outputConnectorIDs":[391976],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Apply Winner Loser Logic"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"trim(regexp_replace(`lines_formattedspread`,'-.*',''))"},"2":{"slot":2,"type":"STRING","value":"projectedWinner"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(regexp_replace(`lines_spread`,'-',''),0)"},"2":{"slot":2,"type":"STRING","value":"spread"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"trim(CASE WHEN `homescore` < `awayscore` THEN `awayteam` ELSE `hometeam` END)"},"2":{"slot":2,"type":"STRING","value":"actualWinner"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ABS(`awayscore`-`homescore`)"},"2":{"slot":2,"type":"STRING","value":"scoreDifference"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391971":{"id":391971,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":496,"y":128,"width":32,"height":32,"inputConnectorIDs":[391979],"outputConnectorIDs":[391991],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter BettingOdds"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rn"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391977":{"id":391977,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":928,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[391990],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"playerstats_passingtdleaders"}}}},"visible":true},"2":{"slot":2,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"playerstats_passingtdleaders"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stat"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"conference"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"stattype"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"player_season"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"player_team"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"category"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"playerid"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"player"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Offset Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"8":{"slot":8,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391980":{"id":391980,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":784,"y":128,"width":32,"height":32,"inputConnectorIDs":[391976],"outputConnectorIDs":[391978],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UpsetAmount BettingOdds"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN trim(`projectedwinner`,' ') <> trim(`actualwinner`,' ') THEN (`spread`+`scoredifference`) \nWHEN trim(`projectedwinner`,' ') = trim(`actualwinner`,' ') THEN ABS(`scoredifference`-`spread`) \nELSE 0 END "},"2":{"slot":2,"type":"STRING","value":"pointDifferential"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN `projectedwinner` = `actualwinner` THEN 'expected winner won' \nELSE 'upset' END"},"2":{"slot":2,"type":"STRING","value":"result"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391981":{"id":391981,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":2139809017,"x":368,"y":128,"width":32,"height":32,"inputConnectorIDs":[391988],"outputConnectorIDs":[391979],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rank BettingOdds"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"hometeam"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"awayteam"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"season"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"awayteam"},"2":{"slot":2,"type":"STRING","value":"Asc"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"hometeam"},"2":{"slot":2,"type":"STRING","value":"Asc"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"season"},"2":{"slot":2,"type":"STRING","value":"Asc"}}}},"visible":true},"5":{"slot":5,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Row Number"},"2":{"slot":2,"type":"STRING","value":"rn"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391982":{"id":391982,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":928,"y":128,"width":32,"height":32,"inputConnectorIDs":[391978,391990],"outputConnectorIDs":[391989],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UpsetAmount BettingOdds"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"games"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"playerstats_passingtdleaders"},"2":{"slot":2,"type":"STRING","value":"away_stats"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"playerstats_passingtdleaders"},"2":{"slot":2,"type":"STRING","value":"home_stats"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"`games`.`awayteam` = `away_stats`.`player_team`\nAND `games`.`season` = `away_stats`.`player_season`"},"2":{"slot":2,"type":"STRING","value":"games_Left_away_stats"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"`games`.`hometeam` = `home_stats`.`player_team`\nAND `games`.`season` = `home_stats`.`player_season`"},"2":{"slot":2,"type":"STRING","value":"games_Left_home_stats"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"games.season"},"2":{"slot":2,"type":"STRING","value":"season"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"games.lines_formattedspread"},"2":{"slot":2,"type":"STRING","value":"lines_formattedspread"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"games.awayteam"},"2":{"slot":2,"type":"STRING","value":"awayteam"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"games.awayscore"},"2":{"slot":2,"type":"STRING","value":"awayscore"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"away_stats.player"},"2":{"slot":2,"type":"STRING","value":"awayQB"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"games.hometeam"},"2":{"slot":2,"type":"STRING","value":"hometeam"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"games.homescore"},"2":{"slot":2,"type":"STRING","value":"homescore"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"home_stats.player"},"2":{"slot":2,"type":"STRING","value":"homeQB"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"games.spread"},"2":{"slot":2,"type":"STRING","value":"spread"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"games.pointdifferential"},"2":{"slot":2,"type":"STRING","value":"pointdifferential"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"games.result"},"2":{"slot":2,"type":"STRING","value":"result"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391983":{"id":391983,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239424,"x":1056,"y":128,"width":32,"height":32,"inputConnectorIDs":[391989],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Write cfbupset"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"3":{"slot":3,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cfbupset"}}}},"visible":true},"4":{"slot":4,"name":"Partition Keys","elements":{},"visible":true},"5":{"slot":5,"name":"Table Properties","elements":{},"visible":true},"6":{"slot":6,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"391976":{"id":391976,"sourceID":391970,"targetID":391980},"391978":{"id":391978,"sourceID":391980,"targetID":391982},"391979":{"id":391979,"sourceID":391981,"targetID":391971},"391988":{"id":391988,"sourceID":391968,"targetID":391981},"391989":{"id":391989,"sourceID":391982,"targetID":391983},"391990":{"id":391990,"sourceID":391977,"targetID":391982},"391991":{"id":391991,"sourceID":391971,"targetID":391970}},"notes":{"391969":{"id":391969,"x":218,"y":-3,"width":254,"height":96,"text":"**GOLD - Cleanse Betting Data & Join to Player**\n- Select all BettingOdds tables\n- Remove duplicate rows\n- Apply Logic to decide largest upset of 5 years of college football\n- Join to Passing Leaders dataset\n- Write to new object","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"Upsets_Gold","description":"","type":"TRANSFORMATION","tag":"a22858dc-b179-41b1-8146-8fe67d9ff1d7"}}